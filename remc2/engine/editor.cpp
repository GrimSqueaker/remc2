#include "editor.h"

bool changed = false;
int stage = 1000;
int minimapx = 0;
int minimapy = 0;

int maptype = 0;

void init_pal() {
	Bit8u temppal[0x300];
	for (int i = 0; i < 256; i++)
	{
		temppal[i * 3] = i;
		temppal[i * 3 + 1] = i;
		temppal[i * 3 + 2] = i;
	}
	VGA_Set_pallette2(temppal);
};

void clean_tarrain()
{
}

void editor_loop();
void terrain_recalculate();


void editor_run()
{	

	sub_6FC50(1);

	//savepal
	//save sceenbuffer
	//save D41A0_BYTESTR_0
	D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5 = 128;
	D41A0_BYTESTR_0.str_2FECE.word_0x2FEE9 = 128;
	D41A0_BYTESTR_0.str_2FECE.word_0x2FEED = 128;
	D41A0_BYTESTR_0.str_2FECE.word_0x2FEF1 = 128;
	D41A0_BYTESTR_0.str_2FECE.word_0x2FEFD = 128;
	D41A0_BYTESTR_0.str_2FECE.word_0x2FF01 = 128;
	D41A0_BYTESTR_0.str_2FECE.word_0x2FF0D = 128;
	D41A0_BYTESTR_0.str_2FECE.word_0x2FF11 = 128;
	init_pal();
	clean_tarrain();
	terrain_recalculate();
	editor_loop();
	//restorepal
	//restore screenbuffer
	//restore D41A0_BYTESTR_0
}

void terrain_recalculate() {
	

	x_WORD_17B4E0 = D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5;
	D41A0_BYTESTR_0.dword_0x8 = D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5;
	memset((void*)x_WORD_15B4E0_source, 0, 0x20000);
	sub_B5E70_decompress_terrain_map_level(x_WORD_17B4E0, D41A0_BYTESTR_0.str_2FECE.word_0x2FEE9, D41A0_BYTESTR_0.str_2FECE.word_0x2FEED, D41A0_BYTESTR_0.str_2FECE.word_0x2FEF1);
	sub_44DB0_truncTerrainHeight();//225db0 //trunc and create
	if (stage > 0)
	{
		memset((void*)x_WORD_15B4E0_source, 0, 0x20000);
		sub_44E40(D41A0_BYTESTR_0.str_2FECE.word_0x2FEF5, D41A0_BYTESTR_0.str_2FECE.word_0x2FEF9);//225e40 //add any fields
	}
	if (stage > 1)
	{
		sub_45AA0_setMax4Tiles();//226aa0
	}

	if (stage > 2)
	{
		sub_440D0(D41A0_BYTESTR_0.str_2FECE.word_0x2FF01);//2250d0
	}
	if (stage > 3)
	{
		sub_45060(D41A0_BYTESTR_0.str_2FECE.word_0x2FF05, D41A0_BYTESTR_0.str_2FECE.word_0x2FF09);//226060
	}
	if (stage > 4)
	{
		sub_44320();//225320
	}
	if (stage > 5)
	{
		sub_45210(D41A0_BYTESTR_0.str_2FECE.word_0x2FF05, D41A0_BYTESTR_0.str_2FECE.word_0x2FF09);//226210
	}
	if (stage > 6)
	{
		sub_454F0(D41A0_BYTESTR_0.str_2FECE.word_0x2FEFD, D41A0_BYTESTR_0.str_2FECE.word_0x2FF11);//2264f0
	}
	if (stage > 7)
	{
		sub_45600(D41A0_BYTESTR_0.str_2FECE.word_0x2FF0D);//226600
	}
	if (stage > 8)
	{
		sub_43FC0();//224fc0
	}
	if (stage > 9)
	{
		memset((void*)x_BYTE_10B4E0_terraintype, 0, 0x10000);
		sub_43970(0);//224970 // smooth terrain
	}
	if (stage > 10)
	{
		sub_43EE0();//224ee0 // add rivers
	}
	if (stage > 11)
	{
		sub_44580();//225580 //set angle of terrain
	}
	if (stage > 12)
	{
		if (x_BYTE_D41B6)
			sub_43B40();//224b40 //change angle of terrain
		else
			sub_43D50();//224d50 //change angle of terrain
	}
	if (stage > 13)
	{
		sub_44D00();//225d00
	}

	changed = false;
};

void drawmenus() {
};
void drawterrain(int x,int y) {
	int k = 0;	
		for (int j = 0; j < 256; j++)
			for (int i = 0; i < 256; i++)
			{
				switch (maptype)
				{
				case 0:
					x_DWORD_180628b_screen_buffer[(j + y) * 640 + (i + x)] = x_BYTE_10B4E0_terraintype[k];
					break;
				case 1:
					x_DWORD_180628b_screen_buffer[(j + y) * 640 + (i + x)] = x_BYTE_11B4E0_height[k];
					break;
				case 2:
					x_DWORD_180628b_screen_buffer[(j + y) * 640 + (i + x)] = x_BYTE_12B4E0_shading[k];
					break;
				case 3:
					x_DWORD_180628b_screen_buffer[(j + y) * 640 + (i + x)] = x_BYTE_13B4E0_angle[k];
					break;
				}
			k++;
		}
};
void drawdetail(int x, int y,int size,int zoom) {
	int k = 0;
	for (int i = 0; i < size; i++)
		for (int j = 0; j < size; j++)
		{
			bool notframe = true;
			int posx = (minimapx)+(i - size / 2) / zoom;
			int posy = (minimapy - 480 + 256) + (j - size / 2) / zoom;
			if (posx < 0) { posx = 0; notframe = false; }
			if (posy < 0) { posy = 0; notframe = false; }
			if (posx > 255) { posx = 255; notframe = false; }
			if (posy > 255) { posy = 255; notframe = false; }
			if (notframe)
			{
				k = 256 * (posy)+posx;
				switch (maptype)
				{
				case 0:
					x_DWORD_180628b_screen_buffer[(j + y) * 640 + (i + x)] = x_BYTE_10B4E0_terraintype[k];
					break;
				case 1:
					x_DWORD_180628b_screen_buffer[(j + y) * 640 + (i + x)] = x_BYTE_11B4E0_height[k];
					break;
				case 2:
					x_DWORD_180628b_screen_buffer[(j + y) * 640 + (i + x)] = x_BYTE_12B4E0_shading[k];
					break;
				case 3:
					x_DWORD_180628b_screen_buffer[(j + y) * 640 + (i + x)] = x_BYTE_13B4E0_angle[k];
					break;
				}
			}
			else
				x_DWORD_180628b_screen_buffer[(j + y) * 640 + (i + x)] = 255;
			//k++;
		}
};

Bit16s editor_regiondata[22 * (24+24+1+4+1)] = {
	//arrow buttons
                                	//position    //size              //type gr      under mou 
0x0000,0x0000,0x0000,0x0000,0x0000,0x00b0,0x0000,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00b8,0x0000,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00c0,0x0000,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0110,0x0000,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0118,0x0000,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0120,0x0000,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,

0x0000,0x0000,0x0000,0x0000,0x0000,0x00b0,0x0010,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00b8,0x0010,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00c0,0x0010,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0110,0x0010,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0118,0x0010,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0120,0x0010,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,

0x0000,0x0000,0x0000,0x0000,0x0000,0x00b0,0x0020,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00b8,0x0020,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00c0,0x0020,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0110,0x0020,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0118,0x0020,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0120,0x0020,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,

0x0000,0x0000,0x0000,0x0000,0x0000,0x00b0,0x0030,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00b8,0x0030,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00c0,0x0030,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0110,0x0030,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0118,0x0030,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0120,0x0030,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,


0x0000,0x0000,0x0000,0x0000,0x0000,0x00b0,0x0040,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00b8,0x0040,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00c0,0x0040,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0110,0x0040,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0118,0x0040,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0120,0x0040,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,

0x0000,0x0000,0x0000,0x0000,0x0000,0x00b0,0x0050,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00b8,0x0050,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00c0,0x0050,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0110,0x0050,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0118,0x0050,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0120,0x0050,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,

0x0000,0x0000,0x0000,0x0000,0x0000,0x00b0,0x0060,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00b8,0x0060,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00c0,0x0060,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0110,0x0060,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0118,0x0060,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0120,0x0060,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,

0x0000,0x0000,0x0000,0x0000,0x0000,0x00b0,0x0070,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00b8,0x0070,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x00c0,0x0070,0x0008,0x0010,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0110,0x0070,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0118,0x0070,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0120,0x0070,0x0008,0x0010,0x0000,0x0506,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
//map click
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x00e0,0x0100,0x0100,0x0000,0x0304,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,

//map type
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x00be,0x0019,0x0019,0x0000,0x0102,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0020,0x00be,0x0019,0x0019,0x0000,0x0102,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0040,0x00be,0x0019,0x0019,0x0000,0x0102,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0060,0x00be,0x0019,0x0019,0x0000,0x0102,0x0101,0x00ff,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0003,


0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000
};

/*
Bit16s x_WORD_E1F84[68] =//in region?
{
	//                                   xmin  ymin   sizex	 sizey        type?
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0123,0x00CD,0x003C,0x003C,0x0000,0x2324,
*/

Bit8u cursor[8 * 8] = {
	0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,
	0xff,0xff,0xff,0x00,0x00,0x00,0x00,0x00,
	0xff,0xff,0xff,0x00,0x00,0x00,0x00,0x00,
	0xff,0x00,0x00,0xff,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0xff,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0xff,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff
};

Bit8u triangleL[16 * 8] = {
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,
	0x00,0x00,0x00,0x00,0x00,0x00,0xff,0xff,
	0x00,0x00,0x00,0x00,0x00,0xff,0x00,0xff,
	0x00,0x00,0x00,0x00,0xff,0x00,0x00,0xff,
	0x00,0x00,0x00,0xff,0x00,0x00,0x00,0xff,
	0x00,0x00,0xff,0x00,0x00,0x00,0x00,0xff,
	0x00,0xff,0x00,0x00,0x00,0x00,0x00,0xff,
	0xff,0x00,0x00,0x00,0x00,0x00,0x00,0xff,
	0xff,0x00,0x00,0x00,0x00,0x00,0x00,0xff,
	0x00,0xff,0x00,0x00,0x00,0x00,0x00,0xff,
	0x00,0x00,0xff,0x00,0x00,0x00,0x00,0xff,
	0x00,0x00,0x00,0xff,0x00,0x00,0x00,0xff,
	0x00,0x00,0x00,0x00,0xff,0x00,0x00,0xff,
	0x00,0x00,0x00,0x00,0x00,0xff,0x00,0xff,
	0x00,0x00,0x00,0x00,0x00,0x00,0xff,0xff,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff
};

Bit8u triangleLfull[16 * 8] = {
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,
	0x00,0x00,0x00,0x00,0x00,0x00,0xff,0xff,
	0x00,0x00,0x00,0x00,0x00,0xff,0xff,0xff,
	0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
	0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,
	0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,
	0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,
	0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,
	0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
	0x00,0x00,0x00,0x00,0x00,0xff,0xff,0xff,
	0x00,0x00,0x00,0x00,0x00,0x00,0xff,0xff,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff
};

Bit8u triangleP[16 * 8] = {
	0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,
	0xff,0x00,0xff,0x00,0x00,0x00,0x00,0x00,
	0xff,0x00,0x00,0xff,0x00,0x00,0x00,0x00,
	0xff,0x00,0x00,0x00,0xff,0x00,0x00,0x00,
	0xff,0x00,0x00,0x00,0x00,0xff,0x00,0x00,
	0xff,0x00,0x00,0x00,0x00,0x00,0xff,0x00,
	0xff,0x00,0x00,0x00,0x00,0x00,0x00,0xff,
	0xff,0x00,0x00,0x00,0x00,0x00,0x00,0xff,
	0xff,0x00,0x00,0x00,0x00,0x00,0xff,0x00,
	0xff,0x00,0x00,0x00,0x00,0xff,0x00,0x00,
	0xff,0x00,0x00,0x00,0xff,0x00,0x00,0x00,
	0xff,0x00,0x00,0xff,0x00,0x00,0x00,0x00,
	0xff,0x00,0xff,0x00,0x00,0x00,0x00,0x00,
	0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,
	0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

Bit8u trianglePfull[16 * 8] = {
	0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,
	0xff,0xff,0xff,0x00,0x00,0x00,0x00,0x00,
	0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,
	0xff,0xff,0xff,0xff,0xff,0x00,0x00,0x00,
	0xff,0xff,0xff,0xff,0xff,0xff,0x00,0x00,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,
	0xff,0xff,0xff,0xff,0xff,0xff,0x00,0x00,
	0xff,0xff,0xff,0xff,0xff,0x00,0x00,0x00,
	0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,
	0xff,0xff,0xff,0x00,0x00,0x00,0x00,0x00,
	0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,
	0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

void drawx(int x,int y, int index,int type=0) {
	if (type > 100)
		;// sub_2BB40_draw_bitmap(x, y, xy_DWORD_17DED4_spritestr[index]);
	switch (index)
	{
	case 0://cursor
	{
		int width = 8;
		int height = 8;
		for (int i = 0; i < width; i++)
			for (int j = 0; j < height; j++)
			{
				if(cursor[i + 8 * j]==0xff)
					*(Bit8u*)(x_DWORD_180628b_screen_buffer + i + x + 640 * (y + j)) = 255;				
			}
		break;
	}
	case 1://rectangle 25
	{
		int width = 25;
		int height = 25;
		for (int i = 0; i < width; i++)
		{
			*(Bit8u*)(x_DWORD_180628b_screen_buffer + i + x + 640 * (y + 0)) = 255;
			*(Bit8u*)(x_DWORD_180628b_screen_buffer + i + x + 640 * (y + height - 1)) = 255;
		}
		for (int j = 0; j < height; j++)
		{
			*(Bit8u*)(x_DWORD_180628b_screen_buffer + x + 0 + 640 * (y + j)) = 255;
			*(Bit8u*)(x_DWORD_180628b_screen_buffer + x + width - 1 + 640 * (y + j)) = 255;
		}
		break;
	}
	case 2://filled rectangle
	{
		int width = 25;
		int height = 25;
		for (int i = 0; i < width; i++)
			for (int j = 0; j < height; j++)
			{
				*(Bit8u*)(x_DWORD_180628b_screen_buffer + i + x + 640 * (y + j)) = 255;
			}
		break;
	}
	case 3://triangleL
	{
		int width = 8;
		int height = 16;
		for (int i = 0; i < width; i++)
			for (int j = 0; j < height; j++)
			{
				if (triangleL[i + width * j] == 0xff)
					* (Bit8u*)(x_DWORD_180628b_screen_buffer + i + x + 640 * (y + j)) = 255;
			}
		break;
	}
	case 4://triangleLfull
	{
		int width = 8;
		int height = 16;
		for (int i = 0; i < width; i++)
			for (int j = 0; j < height; j++)
			{
				if (triangleLfull[i + width * j] == 0xff)
					* (Bit8u*)(x_DWORD_180628b_screen_buffer + i + x + 640 * (y + j)) = 255;
			}
		break;
	}
	case 5://triangleP
	{
		int width = 8;
		int height = 16;
		for (int i = 0; i < width; i++)
			for (int j = 0; j < height; j++)
			{
				if (triangleP[i + width * j] == 0xff)
					* (Bit8u*)(x_DWORD_180628b_screen_buffer + i + x + 640 * (y + j)) = 255;
			}
		break;
	}
	case 6://trianglePfull
	{
		int width = 8;
		int height = 16;
		for (int i = 0; i < width; i++)
			for (int j = 0; j < height; j++)
			{
				if (trianglePfull[i + width * j] == 0xff)
					* (Bit8u*)(x_DWORD_180628b_screen_buffer + i + x + 640 * (y + j)) = 255;
			}
		break;
	}
	}
}

void drawcursor() {
	drawx(x_DWORD_17DEE4_mouse_positionx, x_DWORD_17DEE4_mouse_positiony, 0);
};

void drawtexts() {
	char temp[256];
	//VGA_GotoXY(0xc8/40, 6/25);
	//VGA_Draw_string((char*)"RANDOM SEED");	
	VGA_Draw_stringXYtoBuffer((char*)"RANDOM SEED:", 0, 0, x_DWORD_180628b_screen_buffer);
	sprintf(temp, "%04X", D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5);
	VGA_Draw_stringXYtoBuffer(temp, 210, 0, x_DWORD_180628b_screen_buffer);

	VGA_Draw_stringXYtoBuffer((char*)"SHIFT:", 0, 16, x_DWORD_180628b_screen_buffer);
	sprintf(temp, "%04X", D41A0_BYTESTR_0.str_2FECE.word_0x2FEE9);
	VGA_Draw_stringXYtoBuffer(temp, 210, 16, x_DWORD_180628b_screen_buffer);

	VGA_Draw_stringXYtoBuffer((char*)"HEIGHT:", 0, 32, x_DWORD_180628b_screen_buffer);
	sprintf(temp, "%04X", D41A0_BYTESTR_0.str_2FECE.word_0x2FEED);
	VGA_Draw_stringXYtoBuffer(temp, 210, 32, x_DWORD_180628b_screen_buffer);

	VGA_Draw_stringXYtoBuffer((char*)"NOISE:", 0, 48, x_DWORD_180628b_screen_buffer);
	sprintf(temp, "%04X", D41A0_BYTESTR_0.str_2FECE.word_0x2FEF1);
	VGA_Draw_stringXYtoBuffer(temp, 210, 48, x_DWORD_180628b_screen_buffer);

	VGA_Draw_stringXYtoBuffer((char*)"0x2FEFD:", 0, 64, x_DWORD_180628b_screen_buffer);
	sprintf(temp, "%04X", D41A0_BYTESTR_0.str_2FECE.word_0x2FEFD);
	VGA_Draw_stringXYtoBuffer(temp, 210, 64, x_DWORD_180628b_screen_buffer);

	VGA_Draw_stringXYtoBuffer((char*)"0x2FF01:", 0, 80, x_DWORD_180628b_screen_buffer);
	sprintf(temp, "%04X", D41A0_BYTESTR_0.str_2FECE.word_0x2FF01);
	VGA_Draw_stringXYtoBuffer(temp, 210, 80, x_DWORD_180628b_screen_buffer);

	VGA_Draw_stringXYtoBuffer((char*)"0x2FF0D:", 0, 96, x_DWORD_180628b_screen_buffer);
	sprintf(temp, "%04X", D41A0_BYTESTR_0.str_2FECE.word_0x2FF0D);
	VGA_Draw_stringXYtoBuffer(temp, 210, 96, x_DWORD_180628b_screen_buffer);

	VGA_Draw_stringXYtoBuffer((char*)"0x2FF11:", 0, 112, x_DWORD_180628b_screen_buffer);
	sprintf(temp, "%04X", D41A0_BYTESTR_0.str_2FECE.word_0x2FF11);
	VGA_Draw_stringXYtoBuffer(temp, 210, 112, x_DWORD_180628b_screen_buffer);

	
	//word_0x2FEFD
	//word_0x2FF01
	//word_0x2FF0D
	//word_0x2FF11
	

	sprintf(temp, "X:%d,Y:%d", x_DWORD_17DEE4_mouse_positionx, x_DWORD_17DEE4_mouse_positiony);
	VGA_Draw_stringXYtoBuffer(temp, 450,480-16 , x_DWORD_180628b_screen_buffer);


}

void editor_mouse_events()//25f0e0
{
	int v3; // edx
	Bit16s v0 =0;

	Bit32u i = 0;
	do
	{		
		if (!(x_WORD_17DEEE & 1) || v0)
		{
			if ((editor_regiondata[i + 12] & 0xff) && sub_7B200_in_region(&editor_regiondata[i], x_DWORD_17DEE4_mouse_positionx, x_DWORD_17DEE4_mouse_positiony))//confirm language
				v3 = editor_regiondata[i + 10] & 0xff;
			else
				v3 = (editor_regiondata[i + 10] & 0xff00) >> 8;
			drawx(editor_regiondata[i + 5], editor_regiondata[i + 6], v3);
			//sub_2BB40_draw_bitmap(x_WORD_E1F84[i + 5], x_WORD_E1F84[i + 6], xy_DWORD_17DED4_spritestr[v3]);
		}
		else if (sub_7B200_in_region(&editor_regiondata[i], x_DWORD_17DEE4_mouse_positionx, x_DWORD_17DEE4_mouse_positiony))//change language
		{
			//sub_8F100_sound_proc19(0, 14, 127, 64, 0x64u, 0, 3u);
			//sub_2BB40_draw_bitmap(editor_regiondata[i + 5], editor_regiondata[i + 6], xy_DWORD_17DED4_spritestr[editor_regiondata[i + 10] & 0xff]);//asi vykresleni stisknuteho tlacitka
			drawx(editor_regiondata[i + 5], editor_regiondata[i + 6], editor_regiondata[i + 10] & 0xff);
			v0 = editor_regiondata[i + 11] & 0xff;
			switch (i / 22)
			{
			case 0: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5 -= 256; changed = true; break; }
			case 1: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5-=16; changed = true; break; }
			case 2: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5--; changed = true; break; }
			case 3: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5++; changed = true; break; }
			case 4: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5+=16; changed = true; break; }
			case 5: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5+=256; changed = true; break; }

			case 6: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE9 -= 256; changed = true; break; }
			case 7: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE9 -= 16; changed = true; break; }
			case 8: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE9--; changed = true; break; }
			case 9: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE9++; changed = true; break; }
			case 10: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE9 += 16; changed = true; break; }
			case 11: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEE9 += 256; changed = true; break; }

			case 12: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEED -= 256; changed = true; break; }
			case 13: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEED -= 16; changed = true; break; }
			case 14: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEED--; changed = true; break; }
			case 15: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEED++; changed = true; break; }
			case 16: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEED += 16; changed = true; break; }
			case 17: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEED += 256; changed = true; break; }

			case 18: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEF1 -= 256; changed = true; break; }
			case 19: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEF1 -= 16; changed = true; break; }
			case 20: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEF1--; changed = true; break; }
			case 21: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEF1++; changed = true; break; }
			case 22: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEF1 += 16; changed = true; break; }
			case 23: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEF1 += 256; changed = true; break; }

			case 24: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEFD -= 256; changed = true; break; }
			case 25: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEFD -= 16; changed = true; break; }
			case 26: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEFD--; changed = true; break; }
			case 27: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEFD++; changed = true; break; }
			case 28: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEFD += 16; changed = true; break; }
			case 29: {D41A0_BYTESTR_0.str_2FECE.word_0x2FEFD += 256; changed = true; break; }

			case 30: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF01 -= 256; changed = true; break; }
			case 31: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF01 -= 16; changed = true; break; }
			case 32: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF01--; changed = true; break; }
			case 33: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF01++; changed = true; break; }
			case 34: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF01 += 16; changed = true; break; }
			case 35: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF01 += 256; changed = true; break; }

			case 36: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF0D -= 256; changed = true; break; }
			case 37: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF0D -= 16; changed = true; break; }
			case 38: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF0D--; changed = true; break; }
			case 39: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF0D++; changed = true; break; }
			case 40: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF0D += 16; changed = true; break; }
			case 41: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF0D += 256; changed = true; break; }

			case 42: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF11 -= 256; changed = true; break; }
			case 43: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF11 -= 16; changed = true; break; }
			case 44: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF11--; changed = true; break; }
			case 45: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF11++; changed = true; break; }
			case 46: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF11 += 16; changed = true; break; }
			case 47: {D41A0_BYTESTR_0.str_2FECE.word_0x2FF11 += 256; changed = true; break; }

			case 48: {
				minimapx = x_DWORD_17DEE4_mouse_positionx;
				minimapy = x_DWORD_17DEE4_mouse_positiony;
				break;
			}
			case 49: {maptype = 0; changed = true; break; }
			case 50: {maptype = 1; changed = true; break; }
			case 51: {maptype = 2; changed = true; break; }
			case 52: {maptype = 3; changed = true; break; }					 
			}
			/*
				D41A0_BYTESTR_0.str_2FECE.word_0x2FEE5 = 128;
				D41A0_BYTESTR_0.str_2FECE.word_0x2FEE9 = 128;
				D41A0_BYTESTR_0.str_2FECE.word_0x2FEED = 128;
				D41A0_BYTESTR_0.str_2FECE.word_0x2FEF1 = 128;
			*/
		}
		else
			drawx(editor_regiondata[i + 5], editor_regiondata[i + 6], (editor_regiondata[i + 10] & 0xff00) >> 8);
		i += 22;
	} while (editor_regiondata[i + 10] & 0xff);
}

void editor_loop()
{
	bool runnning = true;
	while (runnning)
	{
		if (x_BYTE_17DF10_get_key_scancode == 59)
		{
			runnning = false;
		}
		memset(x_DWORD_180628b_screen_buffer, 0, 640 * 480);
		
		editor_mouse_events();//25f0e0 adress 258ca1 - zmeni tlacitko, vrati stav kliknuti
		if (changed)
			terrain_recalculate();
		//4527b9=[ebp+66]+6 4527bf 161545005835->58e2e2e2e2e2
		//[ebp+66]+6//save1
		drawmenus();
		drawterrain(0,480-256);
		drawdetail(256,480-256,256,8);
		drawtexts();
		drawcursor();
		sub_75200_VGA_Blit640(480);//vykresleni //256200		
		sub_7A060_get_mouse_and_keyboard_events();//25b060 adress 258ddf
	}
}